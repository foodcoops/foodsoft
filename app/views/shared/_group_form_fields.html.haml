= f.input :name
= f.input :description

= yield

- if f.object.is_a?(Workgroup)
  %h3 WÃ¶chentliche Jobs
  = f.input :weekly_task
  #weekly_task_fields
    = f.input :weekday
    = f.input :task_name
    = f.input :task_required_users
    = f.input :task_duration, :as => :select, :collection => (1..3)
    = f.input :task_description, as: :text, input_html: {rows: 10}
    = f.input :next_weekly_tasks_number

= f.input :user_tokens, :as => :string, :input_html => { 'data-pre' => f.object.users.map { |u| u.token_attributes }.to_json }

- content_for :head do
  :javascript
    function toggleWeeklyTaskFields() {
      if ($('#workgroup_weekly_task').is(':checked')) {
        $('#weekly_task_fields div.input').show();
        $('#weekly_task_fields input').removeAttr('disabled');
      } else {
        $('#weekly_task_fields div.input').hide();
        $('#weekly_task_fields input').attr('disabled', 'disabled');
      }
    }

    $(function() {
      toggleWeeklyTaskFields();
      $('#workgroup_weekly_task').click(function() {
        toggleWeeklyTaskFields();
      });

      $("##{f.object.class.to_s.underscore}_user_tokens").tokenInput("#{users_path(:format => :json)}", {
        crossDomain: false,
        prePopulate: $("##{f.object.class.to_s.underscore}_user_tokens").data("pre"),
        hintText: 'Nach Nutzerin suchen',
        noResultText: 'Keine Nutzerin gefunden',
        searchingText: 'Suche ...'
      });
    });

